<html>
    <!-- Just a test file for now -->
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/sha1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/hmac.min.js"></script>
        <script src="oauth-1.0a.js"></script>
        <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            String.prototype.format = String.prototype.format ||
			function () {
    			"use strict";
    			var str = this.toString();
    			if (arguments.length) {
    			    var t = typeof arguments[0];
    			    var key;
    			    var args = ("string" === t || "number" === t) ?
    			        Array.prototype.slice.call(arguments)
    			        : arguments[0];

    			    for (key in args) {
    			        str = str.replace(new RegExp("\\{" + key + "\\}", "gi"), args[key]);
    			    }
    			}

    			return str;
			};
 
            var yql = 'https://query.yahooapis.com/v1/public/yql';
            var datasource = 'xml';
            var api = 'https://www.goodreads.com/review/list/';
            var resource = '64620959.xml';
            var yqlParams = {
                q: 'select reviews.review.book.title, reviews.review.book.link, reviews.review.book.authors.author.name from {0} where url="{1}"',
                format: 'xml',
                callback: 'yqlCallback',
            };

            var apiParams = {
                key: 'M15FipoFYVCIwLylLqznPw',
                shelf: 'to-read',
                sort: 'title',
                v: '2',
            };

            var uri = (resource) ? api + resource : api;
            uri = $.isEmptyObject(apiParams) ? uri : uri + '?' + $.param(apiParams);

            yqlParams.q = yqlParams.q.format(datasource, uri);

            var request = {
                url: yql + '?' + $.param(yqlParams),
                method: 'GET'
            };

            var oauth = OAuth({
                consumer: {
                    key: 'dj0yJmk9UHpKWUlUUmI4SlpNJmQ9WVdrOWMwaHNiMWN6TkcwbWNHbzlNQS0tJnM9Y29uc3VtZXJzZWNyZXQmeD1hZgâ€”',
                    secret: 'cb60e3582ce27ed08dd77b3bdc0f3c1f27e03bbf'
                },
                signature_method: 'HMAC-SHA1',
                hash_function: function(base_string, key) {
                    return CryptoJS.HmacSHA1(base_string, key).toString(CryptoJS.enc.Base64);
                }
            });

            var yqlCallback = function(data) {
                $('body').text(data.results);
            };

            $.ajax({
                url: request.url,
                type: request.method,
                data: oauth.authorize(request)
            });
        </script>
    </body>
</html>
